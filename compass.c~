/*****************************************************************************
*
*	File Name:  compass.c                                        
*                                                                  
*	Content:    provides a structure for handleling actual and desired compass heading                
*                                                                                                                                
*=============================================================================
*	Revision 1.0 05Oct2010 mck_andrew@yahoo.com
*
*===========================================================================*/
#include "compass.h"
#include "10sk.h"

typedef struct var {
    int current;
    int desired;
} compass;

char strHeading[9];
compass heading;
void init_compass(int desir,int curr){
	heading.current=curr;
	heading.desired=desir;
	strHeading={"         "};
}

void change_heading(int degreeChange){
	if(heading.desired+degreeChange> 359 ){
		heading.desired=heading.desired+degreeChange-360;
	}
	else if(heading.desired+degreeChange<0){
		heading.desired=heading.desired+degreeChange+360;	
	}
	else{
		heading.desired=heading.desired+degreeChange;
	}
}
char* get_heading(void){
	int digits[3];
	digits[0]=(int)heading.desired/100;
	digits[1]=(int)heading.desired/10;
	digits[2]=heading.desired%10;
	int i=0;
	for(i=0;i<3;i++){
		if(digits[i]==0){
			strHeading[3+i]=' ';
		}
		else{
			strHeading[3+i]='0'+digits[i];
		}
	}	
	return &strHeading;
}
void set_compass(float voltage){
	heading.current=degrees;
}
int get_compass(void){
	return heading.current;
}
